<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Editor</title>


    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/lodash.js/3.10.1/lodash.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/backbone.js/1.3.3/backbone.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jointjs/2.1.0/joint.js"></script>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/0.5.0-alpha1/html2canvas.js"></script>
    <script src='https://cdnjs.cloudflare.com/ajax/libs/html2canvas/0.4.1/html2canvas.min.js'></script>
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.5.3/jspdf.min.js"></script>
    <script src="js/bootnavbar.js"></script>

    <link rel="stylesheet" href="css/bootnavbar.css">
    <link rel="stylesheet" href="project.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css"/>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css"/>
</head>

<body>
    <div class = "container-fluid" id = "stencil-container">
        <div class="row">
            <nav class="navbar navbar-expand-lg navbar-light bg-light px-4">
                <a class="navbar-brand" href="#">ERD Builder</a>
                <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
                  <span class="navbar-toggler-icon"></span>
                </button>
              
                <div class="collapse navbar-collapse" id="navbarSupportedContent">
                  <ul class="navbar-nav mr-auto">
                    <li class="nav-item dropdown">
                      <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                        File
                      </a>
                      <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                        <a class="dropdown-item" onclick="newPage()">New</a>
                        <label class="dropdown-item" for="inputfile">Open</label>
                        <div class="dropdown-divider"></div>
                        <a class="dropdown-item disabled" id="nav_save" onclick="saveJSON(false)">Save</a>
                        <a class="dropdown-item" data-toggle="modal" data-target="#downloadModal">Save as</a>
                        <a class="nav-item dropdown">
                            <a class="nav-link dropdown-toggle ml-3" href="#" id="exportAsDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                Export as
                            </a>
                            <div style="left: 100%; top: 64%;" class="dropdown-menu dropright" aria-labelledby="exportAsDropdown">
                                <a class="dropdown-item" onclick="downloadToPdf()">PDF</a>
                                <a class="dropdown-item" onclick="saveJSON(false)">JSON</a>
                                <a class="dropdown-item" id="navSaveButtonImage">IMAGE</a>
                            </div>
                        </a>
                        <div class="dropdown-divider"></div>
                        <a class="dropdown-item" onclick="relationalSchema()">Relational Schema</a>
                        <div class="dropdown-divider"></div>
                        <a class="dropdown-item disabled" id="nav_close" onclick="closeLoadedFile()">Close</a>
                      </div>
                    </li>
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                          Edit
                        </a>
                        <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                          <a class="dropdown-item disabled" id="nav_undo" onclick="undo()">Undo</a>
                          <a class="dropdown-item disabled" id="nav_redo" onclick="redo()">Redo</a>
                          <div class="dropdown-divider"></div>
                          <a class="dropdown-item disabled" id="nav_cut" onclick="cut(false)">Cut</a>
                          <a class="dropdown-item disabled" id="nav_copy" onclick="copy(false)">Copy</a>
                          <a class="dropdown-item disabled" id="nav_paste" onclick="paste(false)">Paste</a>
                          <a class="dropdown-item disabled" id="nav_del" onclick="removeSelected()">Delete</a>
                          <div class="dropdown-divider"></div>
                          <!-- φτιαξε την duplicate -->
                          <a class="dropdown-item disabled" id="nav_dpl" onclick="duplicate(false)">Duplicate</a>
                          <div class="dropdown-divider"></div>
                          <a class="dropdown-item" id="nav_select_all" onclick="selectAll()">Select All</a> 
                        </div>
                      </li>
                      <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                          View
                        </a>
                        <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                          <a class="dropdown-item" onclick="setGrid(false)">Grid</a>
                          <div class="dropdown-divider"></div>
                          <a class="dropdown-item" onclick="clearFunction()">Reset</a>
                          <a class="dropdown-item" onclick="zoomInFunction()">Zoom In</a>
                          <a class="dropdown-item" onclick="zoomOutFunction()">Zoom out</a>
                        </div>
                      </li>
                      <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                          Help
                        </a>
                        <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                            <!-- <div id = "search-container">
                                <input type="text" id = "search-bar" placeholder="Search.." name="search">
                                <label for="search-bar" class="fa fa-search input-icon"></label>
                            </div>           
                            <div class="dropdown-divider"></div> -->
                            <a class="dropdown-item" href="search.html">ER Information</a>
                            <a class="dropdown-item" href="aboutUs.html">About us</a>
                        </div>
                      </li>
                  </ul>

                  <input type="file" name="inputfile" id="inputfile" accept="application/JSON"/>
                  <label for="inputfile"><i class="fa fa-cloud-upload" aria-hidden="true"></i><span class="ml-1" id="filename">Choose file</span></label>
                  <i class="fa fa-times ml-1" id="x_btn" onclick="closeLoadedFile()" aria-hidden="true"></i>
                </div>
              </nav>
        </div>

        <div class= "row" id = "my-row">
            <div class = "col-sm-3" id ="stencil">
                <div class = "stencil-title">
                    <h2 style ="font-family: Lucida Handwriting">ER-Elements</h2>
                </div>
                <button
                    id="btn"
                    class="btn btn-default" 
                    type="button" 
                    data-toggle="collapse" 
                    data-target="#stencil-canvas" 
                    aria-expanded="true" 
                    aria-controls="stencil-canvas" 
                    onclick="changeArrowPosition(this)"
                    >
                    Entities
                    <i class="fa fa-chevron-down"></i>
                </button>

                <div id="stencil-canvas">
                    <div id="stencil-canvas-area" class="card card-body">
                        <div id="stencil-canvas-content" style="width: inherit; overflow: hidden"></div>
                    </div>
                </div> 

                <button
                    id = "btn"
                    class="btn btn-default" 
                    type="button" 
                    data-toggle="collapse"
                    data-target="#stencil-canvas2" 
                    aria-expanded="true" 
                    aria-controls="stencil-canvas2" 
                    onclick="changeArrowPosition(this)"
                    >
                    Attributes
                    <i class="fa fa-chevron-down"></i>
                </button>

                <div id="stencil-canvas2">
                    <div id="stencil-canvas-area2" class="card card-body">
                        <div id="stencil-canvas-content2" style="width: inherit; overflow: hidden" ></div>
                     </div>
                </div> 

                <button
                    id = "btn"
                    class="btn btn-default" 
                    type="button" 
                    data-toggle="collapse" 
                    data-target="#stencil-canvas3" 
                    aria-expanded="false" 
                    aria-controls="stencil-canvas3" 
                    onclick="changeArrowPosition(this)"
                    >
                    Relationships-ISA
                    <i class="fa fa-chevron-down"></i>
                </button>

                <div id="stencil-canvas3">
                    <div id="stencil-canvas-area3" class="card card-body">
                        <div id="stencil-canvas-content3" style="width: inherit; height: inherit; overflow: hidden"></div>
                    </div>
                </div> 
            </div>
           
            
            <div class="col-sm-9" id="main-canvas">
                <div id="up-menu" width="30%">
                    <img src="https://img.icons8.com/wired/64/000000/zoom-in.png" title="Zoom in" width="3.5%" height="3.5%" onclick="zoomInFunction()">
                    <img src="https://img.icons8.com/wired/64/000000/zoom-out.png" title="Zoom out" width="3.5%" height="3.5%" onclick="zoomOutFunction()">
                    <img src="https://img.icons8.com/wired/64/000000/trash.png" title="Delete all/selected" width="4%" height="4%" onclick="clearFunction()">
                    <img src="https://img.icons8.com/metro/26/000000/activity-grid-2.png" title="Enable grid" id="btn_grid" width="3.5%" height="3.5%" onclick="setGrid(false)" >
                    
                    <img src="https://img.icons8.com/carbon-copy/100/000000/save.png" id="btn_save" class="disabled" title="Save" width="5%" height="5%" onclick="saveJSON(false)"/>
                    <img src="https://img.icons8.com/carbon-copy/100/000000/save-as.png" title="Save as" data-toggle="modal" data-target="#downloadModal" width="5%" height="5%"/>
                    <img src="https://img.icons8.com/ios-filled/64/000000/back-sorting.png" title="To Back" width="4%" height="4%" onclick="moveToBack()"/>
                    <img src="https://img.icons8.com/ios-filled/64/000000/front-sorting.png" title="To Front" width="4%" height="4%" onclick="moveToFront()"/>
                    
                    <img src="https://img.icons8.com/metro/26/000000/undo.png" title="Undo" class="disabled" id="btn_undo" width="4%" height="4%" onclick="undo()">
                    <img src="https://img.icons8.com/metro/50/000000/redo.png" title="Redo" class="disabled" id="btn_redo" width="4%" height="4%" onclick="redo()">
                    <img src="https://img.icons8.com/ios/50/000000/one-to-many.png" title="Download relational schema" width="4%" height="4%" onclick="relationalSchema()"/>
                </div>    
                
                <div class="alert alert-warning" style="display: none;" id="warningAlert">
                    <button type="button" class="close" onclick="dismiss('warningAlert')">&times;</button>
                    <strong>Warning! </strong><span id="warning_message"></span>
                </div>

                <div id="paper-canvas" style="padding:0%; width:100%; height:100%"></div>

                <div class="menu" id="gen_menu">
                    <ul class="menu-options">
                        <li id="ctx_paste" class="menu-option disabled" onclick="paste(true)">Paste</li>
                        <li id="ctx_undo" class="menu-option disabled" onclick="undo()">Undo</li>
                        <li id="ctx_redo" class="menu-option disabled" onclick="redo()">Redo</li>
                        <li id="ctx_save" class="menu-option disabled" onclick="saveJSON(false)">Save</li>
                        <li class="menu-option" data-toggle="modal" data-target="#downloadModal">Save As</li>
                    </ul>
                </div>
                <div class="menu" id="el_menu">
                    <ul class="menu-options">
                        <li id="ctx_del" class="menu-option" onclick="deleteElement()">Delete</li>
                        <li class="menu-option" onclick="cut(true)">Cut</li>
                        <li class="menu-option" onclick="copy(true)">Copy</li>
                        <li id="ctx_dpl" class="menu-option" onclick="duplicate(true)">Duplicate</li>
                        <li id="ctx_to_front" class="menu-option" onclick="moveToFront()">To Front</li>
                        <li id="ctx_to_back" class="menu-option" onclick="moveToBack()">To Back</li>
                        <li id="ctx_break" class="menu-option" onclick="breakConnections()">Break all connections</li>
                    </ul>
                </div>
            </div>
            <div id="help" class="col-sm-2">
                <div id="helpbox">
                    <h3 id="helpbox-title" style ="font-family: Lucida Handwriting">
                        <u class="float-left">Set BOX</u>
                        <i class="fa fa-close float-right" style="cursor: pointer;" onclick="dismiss('help')"></i>
                    </h3>
                    <div class="mt-5" id="element-helpbox-content">
                        <!-- onfocusout works the same as onchange with input type text -->
                        <input id="input-el-name" type="text" oninput="updateName(this.value)" onchange="addState()" placeholder="element_name">
                        <div><small>* Complex key? Separate by ;</small></div>
                        <hr>
                        <div>
                            Font Size:
                            <p></p>
                            <input type="number" id="fontSize" maxlength="2" size="2" oninput="updateFontSize(this.value)" onchange="addState()">
                        </div>
                        <br>
                        Change style of letters:
                        <p></p>
                        <select id="fontFamily" data-selected="" onchange="updateFontFamily(this.value)">
                            <option value="Arial" selected="selected">Arial</option>
                            <option value="Times New Roman">Times New Roman</option>
                            <option value="Times">Times</option>
                            <option value="serif">serif</option>
                            <option value="comic">comic</option>
                            <option value="Helvetica">Helvetica</option>
                            <option value="sans-serif">sans-serif</option>
                            <option value="Lucida Console">Lucida Console</option>
                            <option value="Courier New">Courier New</option>
                            <option value="monospace">monospace</option>
                        </select>
                        <hr>
                        <input id="input-el-width-text" type="number" oninput="updateWidth(this)" onfocusout="addState()" min="20" max="300" placeholder="element_width">
                        <p></p>
                        <input id="input-el-width-range" class="slider-pic" type="range" oninput="updateWidth(this)" onchange="addState()" min="20" max="300" step="1">
                        <hr>
                        <input id="input-el-height-text" type="number" oninput="updateHeight(this)" onfocusout="addState()" min="20" max="300" placeholder="element_height">
                        <p></p>
                        <input id="input-el-height-range" class="slider-pic" type="range" oninput="updateHeight(this)" onchange="addState()" min="20" max="300" step="1">
                        <hr>
                        <div class="form-check" id="isWeakKeyDiv">
                            <input type="checkbox" onchange="isWeakKey()" class="form-check-input" id="isWeakKey">
                            <label class="form-check-label" for="isWeakKey">Weak Entity key?</label>
                        </div>
                        <div class="form-check" id="isCoveringDiv">
                            <input type="checkbox" class="form-check-input" id="isCoveringIsa" onchange="isCoveringIsa()">
                            <label class="form-check-label" for="isCoveringIsa">Is Covering ?</label>
                        </div>   
                    </div>
                    <div class="mt-5" id="link-helpbox-content"></div>
                </div>
            </div>
        </div>
    </div> 
    
    <!-- Modal -->
    <div class="modal fade" id="downloadModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-body">
                Choose a name for your file:
                <div class="form-group">
                    <label><b>File Name:</b></label>
                    <input type="text" id="inputDownloadName" placeholder="file_name">
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                <button type="button" class="btn btn-primary" id="saveButtonJSON" data-dismiss="modal">Save as JSON</button>
                <button type="button" class="btn btn-primary" id="saveButtonImage" data-dismiss="modal">Save as IMAGE</button>
                <button type="button" class="btn btn-primary" id="saveButtonPDF" data-dismiss="modal" onclick="downloadToPdf()">Save as PDF</button>
            </div>
        </div>
    </div>

    <div class="modal fade" id="query_modal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-body" id="query_modal_text" style="text-align: center;">
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary" id="yesButton" data-dismiss="modal">Yes</button>
                <button type="button" class="btn btn-secondary" data-dismiss="modal">No</button>
            </div>
        </div>
    </div>

    <script type="text/javascript" src="relational_schema.js"></script>
    <script type="text/javascript" src="navbar_utils.js"></script>
    <script type="text/javascript" src="utils.js"></script>
    <script type="text/javascript" src="custom_elements.js"></script>
    <script type="text/javascript" src="storage_handling.js"></script>
    <script type="text/javascript" src="tools.js"></script>
    <script type="text/javascript" src="paper.js"></script>
    <script type="text/javascript" src="context_menu.js"></script>
    <script type="text/javascript" src="stencil.js"></script>
    <script type="text/javascript" src="helpbox.js"></script>
    
    </div>
</body>
</html>
